<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Intro</title>
  <style>
    html,body{height:100%;margin:0}
    body{display:flex;align-items:center;justify-content:center;background:#000}
    .player{width:100%;height:100%;display:flex;align-items:center;justify-content:center}
    video{max-width:100%;max-height:100%;width:100%;height:auto;display:block}
    .skip{position:fixed;right:1rem;top:1rem;z-index:999;padding:.5rem .75rem;background:rgba(0,0,0,.6);color:#fff;border-radius:8px;border:1px solid rgba(255,255,255,.08);cursor:pointer}
  </style>
</head>
<body>
  <button class="skip" id="skipBtn">Saltar</button>
  <div class="player">
    <video id="introVideo" playsinline webkit-playsinline muted autoplay>
      <source src="/media/xlerionIntro.mp4" type="video/mp4">
      Tu navegador no soporta video HTML5.
    </video>
  </div>

  <script>
    (function(){
      const video = document.getElementById('introVideo');
      const skip = document.getElementById('skipBtn');
      const target = '/?no_intro=1'; // redirige a la página principal sin volver a mostrar el intro

      // Helper para redirigir (sin marcar cookie). usamos replace para no añadir entrada en el historial
      function goHome(){
        window.location.replace(target);
      }

      // Cuando termine el video -> redirige
      video.addEventListener('ended', goHome);

      // Botón saltar -> redirige
      skip.addEventListener('click', goHome);

      // Intentar reproducir si el autoplay está bloqueado (muchos navegadores requieren interacción)
      function tryPlay(){
        const p = video.play();
        if(p && p.catch){
          p.catch(()=>{
            // mostrar el botón de salto prominente para que el usuario avance
            skip.style.display = 'block';
            // Un clic en la pantalla reproducirá en muchos navegadores; añadimos un listener
            document.body.addEventListener('click', function once(){
              video.play().catch(()=>{});
              document.body.removeEventListener('click', once);
            });
          });
        }
      }

      // Ocultar el botón de saltar sólo si el dev quiere (por ahora visible)
      skip.style.display = 'block';

      // Arranca intento de autoplay
      tryPlay();

    })();
  </script>
</body>
</html>
